jQuery.fn.currencyFormat=function(){return this.each(function(){var e=this.value;if(""!==e&&"."!==e){var n=e.split(".");""===n[0]&&(n[0]=0,this.value=n.join(".")),n[0].startsWith(0)&&("0"!==n[0]||n[1])&&(n[0]=parseInt(n[0]),this.value=n.join(".")),n[1]&&2<n[1].length&&(n[1]=n[1].substring(0,2),this.value=n.join("."))}else this.value=""}),this},jQuery(document).ready(function(p){p(".toplevel_page_wp-weixin .stuffbox form h2").each(function(e,n){var i=p(n),t=p(i).next(".section-class-holder").data("section_class");i.addClass(t)});var i={responder:{handle:p(".wp_weixin-responder-section.wp_weixin-responder-field input"),content:p(".wp_weixin-responder-section:not( .wp_weixin-responder-field )")},proxy:{handle:p(".wp_weixin-proxy-section.wp_weixin-proxy-field input"),content:p(".wp_weixin-proxy-section:not( .wp_weixin-proxy-field )")},auth:{handle:p(".wp_weixin-enable_auth-field input"),content:p(".wp_weixin-force_wechat-field, .wp_weixin-force_follower-field, .wp_weixin-ecommerce_force_follower-field, .wp_weixin-show_bind_link-field, .wp_weixin-show_auth_link-field")}},e=[p(".wp_weixin-follow_welcome-field input")];function t(){p.each(e,function(e,n){n.prop("checked")&&(i.responder.handle.prop("checked",!0),i.responder.content.show())})}p.each(i,function(e,n){n.handle.prop("checked")?n.content.show():n.content.hide(),n.handle.on("change",function(){p(this).prop("checked")?n.content.show():n.content.hide()})}),p.each(e,function(e,n){n.prop("checked")&&!i.responder.handle.prop("checked")&&(i.responder.handle.prop("checked",!0),i.responder.handle.trigger("change")),n.on("change",t)}),i.responder.handle.on("change",t),p(".wp_weixin-force_auth-field input").prop("checked")&&p(".wp_weixin-enable_auth-field input").prop("checked",!0),p(".wp_weixin-enable_auth-field input, .wp_weixin-force_auth-field input").on("change",function(){p(".wp_weixin-force_auth-field input").prop("checked")&&p(".wp_weixin-enable_auth-field input").prop("checked",!0)}),p('input[type="password"].toggle').on("focus",function(){p(this).attr("type","text")}),p('input[type="password"].toggle').on("blur",function(){p(this).attr("type","password")}),p("#wp_weixin_qr_amount").on("keyup",function(e){e.preventDefault(),p(this).currencyFormat()}),p(".qr-button").on("click",function(e){e.preventDefault();var n,i=p(this),t=p("#"+i.data("img")),o=p("#qr_url").val();(n=i.hasClass("qr-payment-button")?{amount:p("#wp_weixin_qr_amount").val(),fixed:p("#wp_weixin_qr_amount_fixed").prop("checked"),productName:p("#wp_weixin_qr_product_name").val(),url:t.data("default_url")}:{url:o}).action="wp_weixin_get_settings_qr",p.ajax({url:WpWeixin.ajax_url,type:"POST",data:n}).done(function(e){e.success?(t.attr("src",t.data("base_url")+e.data),t.css("visibility","visible"),t.parent().children("span").hide()):(t.css("visibility","hidden"),t.parent().children("span").show())}).fail(function(e,n){WpWeixin.debug&&window.console.log(n)})})});